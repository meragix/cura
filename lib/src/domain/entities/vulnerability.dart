class Vulnerability {
  final String id;
  final String summary;
  final String details;
  final VulnerabilitySeverity severity;
  final DateTime published;
  final DateTime? modified;
  final List<String> affectedVersions;
  final String? fixedVersion;
  final List<String> references;

  const Vulnerability({
    required this.id,
    required this.summary,
    required this.details,
    required this.severity,
    required this.published,
    this.modified,
    required this.affectedVersions,
    this.fixedVersion,
    required this.references,
  });

  bool get hasFixAvailable => fixedVersion != null;
  bool get isCritical => severity == VulnerabilitySeverity.critical;
  bool get isHigh => severity == VulnerabilitySeverity.high;

  int get daysSincePublished => DateTime.now().difference(published).inDays;

  @override
  String toString() => 'Vulnerability($id, severity: $severity)';
}

/// Severity levels (aligned with OSV.dev)
enum VulnerabilitySeverity {
  critical,
  high,
  medium,
  low,
  unknown;

  static VulnerabilitySeverity fromString(String value) {
    return switch (value.toLowerCase()) {
      'critical' => critical,
      'high' => high,
      'medium' => medium,
      'low' => low,
      _ => unknown,
    };
  }
}
